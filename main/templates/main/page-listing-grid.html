{% extends 'base.html' %}

{% load static %}

{% block title %}Products - Listing{% endblock %}

{% block nav %}
<nav class="navbar navbar-main navbar-expand-lg border-bottom">
	<div class="container">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_nav"
			aria-controls="main_nav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="main_nav">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="{% url 'main:home' %}">Home</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="{% url 'main:product_list' %}">All Products</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Services</a>
				</li>
			</ul>
		</div>
	</div>
</nav>
{% endblock %}

{% block content %}

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y">
	<div class="container">

		<!-- ============================  FILTER TOP  ================================= -->
		<div class="card mb-3">
			<div class="card-body">
				<div class="row">
					<div class="col-md-2"> Your are here: </div>
					<nav class="col-md-8">
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="{% url 'main:home' %}">Home</a></li>
							<li class="breadcrumb-item active" aria-current="page">Products</li>
						</ol>
					</nav>
				</div>
				<hr>
				<div class="row">
					<div class="col-md-2">Filter by</div>
					<div class="col-md-10">
						<ul class="list-inline">
							<li class="list-inline-item mr-3 dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Category</a>
								<div class="dropdown-menu">
									{% for cat in categories %}
									<a href="?category={{ cat.slug }}" class="dropdown-item">{{ cat.name }}</a>
									{% endfor %}
								</div>
							</li>
							<li class="list-inline-item mr-3 dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Country</a>
								<div class="dropdown-menu p-3">
									{% for country in countries %}
									<label class="form-check">
										<input type="checkbox" class="form-check-input"
											onchange="window.location.href='?country={{ country.id }}'">
										{{ country.name }}
									</label>
									{% endfor %}
								</div>
							</li>
							<li class="list-inline-item mr-3 dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Condition</a>
								<div class="dropdown-menu">
									<a href="?condition=new" class="dropdown-item">New</a>
									<a href="?condition=used" class="dropdown-item">Used</a>
									<a href="?condition=refurbished" class="dropdown-item">Refurbished</a>
								</div>
							</li>
							<li class="list-inline-item mr-3">
								<div class="form-inline">
									<label class="mr-2">Price</label>
									<form method="GET" class="form-inline">
										<input class="form-control form-control-sm" name="min_price" placeholder="Min"
											type="number" value="{{ request.GET.min_price }}">
										<span class="px-2"> - </span>
										<input class="form-control form-control-sm" name="max_price" placeholder="Max"
											type="number" value="{{ request.GET.max_price }}">
										<button type="submit" class="btn btn-sm btn-light ml-2">Ok</button>
									</form>
								</div>
							</li>
							<li class="list-inline-item mr-3">
								<label class="custom-control mt-1 custom-checkbox">
									<input type="checkbox" class="custom-control-input"
										onchange="window.location.href='?verified=true'">
									<div class="custom-control-label">Verified only
									</div>
								</label>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- ============================ FILTER TOP END.// ================================= -->

		<header class="mb-3">
			<div class="form-inline">
				<strong class="mr-md-auto">{{ page_obj.paginator.count }} Items found </strong>

				<div class="btn-group">
					<a href="{% url 'main:product_list' %}" class="btn btn-light active" data-toggle="tooltip"
						title="Grid view">
						<i class="fa fa-th"></i></a>
					<a href="{% url 'main:product_list_large' %}" class="btn btn-light" data-toggle="tooltip"
						title="List view">
						<i class="fa fa-bars"></i></a>
				</div>
			</div>
		</header>

		<div class="row">
			{% for product in products %}
			<div class="col-md-3">
				<figure class="card card-product-grid">
					<div class="img-wrap">
						{% if product.recommended %}
						<span class="badge badge-danger"> NEW </span>
						{% endif %}
						<a href="{% url 'main:product_detail' product.slug %}">
							<img src="{{ product.main_image.url }}" alt="{{ product.title }}">
						</a>
					</div>
					<figcaption class="info-wrap">
						<a href="{% url 'main:product_detail' product.slug %}" class="title mb-2">
							{{ product.title|truncatewords:10 }}</a>
						<div class="price-wrap">
							<span class="price">${{ product.price }}</span>
							<small class="text-muted">/per item</small>
						</div>

						<p class="mb-2"> {{ product.quantity }} Pieces <small class="text-muted">(Available)</small></p>

						{% if product.company %}
						<p class="text-muted">{{ product.get_company_display }}</p>
						{% endif %}

						<hr>

						<p class="mb-3">
							{% if product.verified %}
							<span class="tag"> <i class="fa fa-check"></i> Verified</span>
							{% endif %}
							{% if product.year %}
							<span class="tag"> {{ product.year }} </span>
							{% endif %}
							<span class="tag"> {{ product.review }} reviews </span>
							{% if product.country %}
							<span class="tag"> {{ product.country.name }} </span>
							{% endif %}
						</p>

						<label class="custom-control mb-3 custom-checkbox">
							<input type="checkbox" class="custom-control-input">
							<div class="custom-control-label">Add to compare
							</div>
						</label>

						<a href="{% url 'main:product_detail' product.slug %}" class="btn btn-outline-primary">
							<i class="fa fa-eye"></i> View Details
						</a>

					</figcaption>
				</figure>
			</div>
			{% empty %}
			<div class="col-12">
				<div class="alert alert-info text-center">
					No products found. Try adjusting your filters.
				</div>
			</div>
			{% endfor %}
		</div>

		<!-- Pagination -->
		{% if is_paginated %}
		<nav class="mb-4" aria-label="Page navigation">
			<ul class="pagination">
				{% if page_obj.has_previous %}
				<li class="page-item"><a class="page-link"
						href="?page={{ page_obj.previous_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.country %}&country={{ request.GET.country }}{% endif %}">Previous</a>
				</li>
				{% else %}
				<li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
				{% endif %}

				{% for num in page_obj.paginator.page_range %}
				{% if page_obj.number == num %}
				<li class="page-item active"><a class="page-link" href="#">{{ num }}</a></li>
				{% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %} <li class="page-item"><a
						class="page-link"
						href="?page={{ num }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.country %}&country={{ request.GET.country }}{% endif %}">{{
						num }}</a></li>
					{% endif %}
					{% endfor %}

					{% if page_obj.has_next %}
					<li class="page-item"><a class="page-link"
							href="?page={{ page_obj.next_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.country %}&country={{ request.GET.country }}{% endif %}">Next</a>
					</li>
					{% else %}
					<li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
					{% endif %}
			</ul>
		</nav>
		{% endif %}

		<div class="box text-center">
			<p>Did you find what you were looking forï¼Ÿ</p>
			<a href="#" class="btn btn-light">Yes</a>
			<a href="#" class="btn btn-light">No</a>
		</div>

	</div>
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

<!-- ========================= SECTION SUBSCRIBE  ========================= -->
<section class="padding-y-lg bg-light border-top">
	<div class="container">

		<p class="pb-2 text-center">Delivering the latest product trends and industry news straight to your inbox</p>

		<div class="row justify-content-md-center">
			<div class="col-lg-4 col-sm-6">
				<form class="form-row">
					<div class="col-8">
						<input class="form-control" placeholder="Your Email" type="email">
					</div>
					<div class="col-4">
						<button type="submit" class="btn btn-block btn-warning"> <i class="fa fa-envelope"></i>
							Subscribe </button>
					</div>
				</form>
				<small class="form-text">We'll never share your email address with a third-party. </small>
			</div>
		</div>

	</div>
</section>
<!-- ========================= SECTION SUBSCRIBE END// ========================= -->

{% endblock content %}