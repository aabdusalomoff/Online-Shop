{% extends 'base.html' %}

{% load static %}

{% block title %}Products - List View{% endblock %}

{% block nav %}
<nav class="navbar navbar-main navbar-expand-lg border-bottom">
  <div class="container">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_nav" aria-controls="main_nav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="main_nav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'main:home' %}">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'main:product_list' %}">All Products</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Services</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
{% endblock %}

{% block content %}

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y">
<div class="container">

<!-- ============================  FILTER TOP  ================================= -->
<div class="card mb-3">
	<div class="card-body">
		<ol class="breadcrumb float-left">
			<li class="breadcrumb-item"><a href="{% url 'main:home' %}">Home</a></li>
			<li class="breadcrumb-item active">Products</li>
		</ol>
	</div>
</div>
<!-- ============================ FILTER TOP END.// ================================= -->

<div class="row">
	<aside class="col-md-2">

	<article class="filter-group">
		<h6 class="title">
			<a href="#" class="dropdown-toggle" data-toggle="collapse" data-target="#collapse_1">Product Categories</a>
		</h6>
		<div class="filter-content collapse show" id="collapse_1">
			<div class="inner">
				<ul class="list-menu">
					{% for cat in categories %}
						<li><a href="?category={{ cat.slug }}">{{ cat.name }}</a></li>
					{% endfor %}
				</ul>
			</div>
		</div>
	</article>

	<article class="filter-group">
		<h6 class="title">
			<a href="#" class="dropdown-toggle" data-toggle="collapse" data-target="#collapse_2">Companies</a>
		</h6>
		<div class="filter-content collapse show" id="collapse_2">
			<div class="inner">
				<label class="custom-control custom-checkbox">
				  <input type="checkbox" class="custom-control-input" onchange="window.location.href='?company=apple'">
				  <div class="custom-control-label">Apple</div>
				</label>
				<label class="custom-control custom-checkbox">
				  <input type="checkbox" class="custom-control-input" onchange="window.location.href='?company=samsung'">
				  <div class="custom-control-label">Samsung</div>
				</label>
				<label class="custom-control custom-checkbox">
				  <input type="checkbox" class="custom-control-input" onchange="window.location.href='?company=nike'">
				  <div class="custom-control-label">Nike</div>
				</label>
				<label class="custom-control custom-checkbox">
				  <input type="checkbox" class="custom-control-input" onchange="window.location.href='?company=adidas'">
				  <div class="custom-control-label">Adidas</div>
				</label>
			</div>
		</div>
	</article>

	<article class="filter-group">
		<h6 class="title">
			<a href="#" class="dropdown-toggle" data-toggle="collapse" data-target="#collapse_3">Price range</a>
		</h6>
		<div class="filter-content collapse show" id="collapse_3">
			<div class="inner">
				<form method="GET">
					<div class="form-row">
						<div class="form-group col-md-6">
						  <label>Min</label>
						  <input class="form-control" name="min_price" placeholder="$0" type="number" value="{{ request.GET.min_price }}">
						</div>
						<div class="form-group text-right col-md-6">
						  <label>Max</label>
						  <input class="form-control" name="max_price" placeholder="$1000" type="number" value="{{ request.GET.max_price }}">
						</div>
					</div>
					<button class="btn btn-block btn-primary">Apply</button>
				</form>
			</div>
		</div>
	</article>

	<article class="filter-group">
		<h6 class="title">
			<a href="#" class="dropdown-toggle" data-toggle="collapse" data-target="#collapse_4">Sizes</a>
		</h6>
		<div class="filter-content collapse show" id="collapse_4">
			  <div class="inner">
			  	<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=xs'">
				    <span class="btn btn-light"> XS </span>
				</label>
				<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=s'">
				    <span class="btn btn-light"> S </span>
				</label>
				<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=m'">
				    <span class="btn btn-light"> M </span>
				</label>
				<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=l'">
				    <span class="btn btn-light"> L </span>
				</label>
				<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=xl'">
				    <span class="btn btn-light"> XL </span>
				</label>
				<label class="checkbox-btn">
				    <input type="checkbox" onchange="window.location.href='?size=xxl'">
				    <span class="btn btn-light"> XXL </span>
				</label>
			  </div>
		</div>
	</article>

	<article class="filter-group">
		<h6 class="title">
			<a href="#" class="dropdown-toggle" data-toggle="collapse" data-target="#collapse_5">Condition</a>
		</h6>
		<div class="filter-content collapse show" id="collapse_5">
			<div class="inner">
				<label class="custom-control custom-radio">
				  <input type="radio" name="condition" class="custom-control-input" onchange="window.location.href='?'">
				  <div class="custom-control-label">Any condition</div>
				</label>
				<label class="custom-control custom-radio">
				  <input type="radio" name="condition" class="custom-control-input" onchange="window.location.href='?condition=new'">
				  <div class="custom-control-label">Brand new</div>
				</label>
				<label class="custom-control custom-radio">
				  <input type="radio" name="condition" class="custom-control-input" onchange="window.location.href='?condition=used'">
				  <div class="custom-control-label">Used items</div>
				</label>
				<label class="custom-control custom-radio">
				  <input type="radio" name="condition" class="custom-control-input" onchange="window.location.href='?condition=refurbished'">
				  <div class="custom-control-label">Refurbished</div>
				</label>
			</div>
		</div>
	</article>

	</aside> <!-- col.// -->
	<main class="col-md-10">

<header class="mb-3">
		<div class="form-inline">
			<strong class="mr-md-auto">{{ page_obj.paginator.count }} Items found</strong>
			<form method="GET" class="mr-2">
				<select class="form-control" name="sort" onchange="this.form.submit()">
					<option value="-created_at" {% if request.GET.sort == "-created_at" %}selected{% endif %}>Latest items</option>
					<option value="-recommended" {% if request.GET.sort == "-recommended" %}selected{% endif %}>Trending</option>
					<option value="-star" {% if request.GET.sort == "-star" %}selected{% endif %}>Most Popular</option>
					<option value="price" {% if request.GET.sort == "price" %}selected{% endif %}>Cheapest</option>
					<option value="-price" {% if request.GET.sort == "-price" %}selected{% endif %}>Most Expensive</option>
				</select>
			</form>
			<div class="btn-group">
				<a href="{% url 'main:product_list' %}" class="btn btn-light" data-toggle="tooltip" title="Grid view"> 
					<i class="fa fa-bars"></i></a>
				<a href="{% url 'main:product_list_large' %}" class="btn btn-light active" data-toggle="tooltip" title="List view"> 
					<i class="fa fa-th"></i></a>
			</div>
		</div>
</header>

{% for product in products %}
<article class="card card-product-list">
	<div class="row no-gutters">
		<aside class="col-md-3">
			<a href="{% url 'main:product_detail' product.slug %}" class="img-wrap">
				{% if product.recommended %}
					<span class="badge badge-danger"> NEW </span>
				{% endif %}
				<img src="{{ product.main_image.url }}" alt="{{ product.title }}">
			</a>
		</aside>
		<div class="col-md-6">
			<div class="info-main">
				<a href="{% url 'main:product_detail' product.slug %}" class="h5 title">{{ product.title }}</a>
				<div class="rating-wrap mb-2">
					<ul class="rating-stars">
						<li style="width:{{ product.star }}0%" class="stars-active"> 
							<i class="fa fa-star"></i> <i class="fa fa-star"></i> 
							<i class="fa fa-star"></i> <i class="fa fa-star"></i> 
							<i class="fa fa-star"></i> 
						</li>
						<li>
							<i class="fa fa-star"></i> <i class="fa fa-star"></i> 
							<i class="fa fa-star"></i> <i class="fa fa-star"></i> 
							<i class="fa fa-star"></i> 
						</li>
					</ul>
					<div class="label-rating">{{ product.star }}/10</div>
				</div>
			
				<p class="mb-3">
					{% if product.verified %}
						<span class="tag"> <i class="fa fa-check"></i> Verified</span>
					{% endif %}
					{% if product.year %}
						<span class="tag"> {{ product.year }} </span>
					{% endif %}
					<span class="tag"> {{ product.review }} reviews </span>
					{% if product.country %}
						<span class="tag"> {{ product.country.name }} </span>
					{% endif %}
				</p>

				<p>{{ product.desc|truncatewords:30 }}</p>

			</div>
		</div>
		<aside class="col-sm-3">
			<div class="info-aside">
				<div class="price-wrap">
					<span class="h5 price">${{ product.price }}</span> 
					<small class="text-muted">/per item</small>
				</div>
				{% if product.dicount > 0 %}
					<small class="text-warning">{{ product.dicount }}% OFF</small>
				{% else %}
					<small class="text-success">Best price</small>
				{% endif %}
				
				{% if product.company %}
					<p class="text-muted mt-3">{{ product.get_company_display }}</p>
				{% endif %}
				
				<p class="mt-3">
					<a href="{% url 'main:product_detail' product.slug %}" class="btn btn-outline-primary"> 
						<i class="fa fa-eye"></i> View Details 
					</a>
					<a href="#" class="btn btn-light"><i class="fa fa-heart"></i> Save </a>
				</p>

				<label class="custom-control mt-3 custom-checkbox">
					  <input type="checkbox" class="custom-control-input">
				  	  <div class="custom-control-label">Add to compare
				  </div>
				</label>

			</div>
		</aside>
	</div>
</article>
{% empty %}
<div class="alert alert-info text-center">
	No products found. Try adjusting your filters.
</div>
{% endfor %}

<!-- Pagination -->
{% if is_paginated %}
<nav class="mb-4" aria-label="Page navigation">
  <ul class="pagination">
    {% if page_obj.has_previous %}
    	<li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">Previous</a></li>
    {% else %}
    	<li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
    {% endif %}
    
    {% for num in page_obj.paginator.page_range %}
    	{% if page_obj.number == num %}
    		<li class="page-item active"><a class="page-link" href="#">{{ num }}</a></li>
    	{% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
    		<li class="page-item"><a class="page-link" href="?page={{ num }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">{{ num }}</a></li>
    	{% endif %}
    {% endfor %}
    
    {% if page_obj.has_next %}
    	<li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">Next</a></li>
    {% else %}
    	<li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
    {% endif %}
  </ul>
</nav>
{% endif %}

<div class="box text-center">
	<p>Did you find what you were looking forï¼Ÿ</p>
	<a href="#" class="btn btn-light">Yes</a>
	<a href="#" class="btn btn-light">No</a>
</div>

	</main>

</div>

</div>
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

<!-- ========================= SECTION SUBSCRIBE  ========================= -->
<section class="padding-y-lg bg-light border-top">
<div class="container">

<p class="pb-2 text-center">Delivering the latest product trends and industry news straight to your inbox</p>

<div class="row justify-content-md-center">
	<div class="col-lg-4 col-sm-6">
		<form class="form-row">
			<div class="col-8">
				<input class="form-control" placeholder="Your Email" type="email">
			</div>
			<div class="col-4">
				<button type="submit" class="btn btn-block btn-warning"> <i class="fa fa-envelope"></i> Subscribe </button>
			</div>
		</form>
		<small class="form-text">We'll never share your email address with a third-party.</small>
	</div>
</div>

</div>
</section>
<!-- ========================= SECTION SUBSCRIBE END// ========================= -->

{% endblock content %}