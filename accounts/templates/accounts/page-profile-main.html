{% extends 'base.html' %}

{% load static %}

{% block title %}My Account - Profile{% endblock %}

{% block nav %}
<nav class="navbar navbar-main navbar-expand-lg border-bottom">
<div class="container">
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_nav" aria-controls="main_nav" aria-expanded="false" aria-label="Toggle navigation">
	<span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse" id="main_nav">
	<ul class="navbar-nav">
		<li class="nav-item">
			<a class="nav-link" href="{% url 'main:home' %}">Home</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="{% url 'main:product_list' %}">All Products</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="#">Services</a>
		</li>
	</ul>
	</div>
</div>
</nav>
{% endblock %}

{% block content %}

<!-- ========================= SECTION PAGETOP ========================= -->
<section class="section-pagetop bg-gray">
<div class="container">
	<h2 class="title-page">My account</h2>
</div>
</section>
<!-- ========================= SECTION PAGETOP END// ========================= -->
	
<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y">
<div class="container">

<div class="row">
	<aside class="col-md-3">
		<nav class="list-group">
			<a class="list-group-item active" href="{% url 'accounts:profile_main' %}"> Account overview  </a>
			<a class="list-group-item" href="{% url 'accounts:profile_address' %}"> My Address </a>
			<a class="list-group-item" href="{% url 'accounts:profile_orders' %}"> My Orders </a>
			<a class="list-group-item" href="{% url 'accounts:profile_wishlist' %}"> My wishlist </a>
			{% if user.status == 'seller' %}
				<a class="list-group-item" href="{% url 'accounts:profile_seller' %}"> My Selling Items </a>
			{% endif %}
			<a class="list-group-item" href="{% url 'accounts:profile_settings' %}"> Settings </a>
			<a class="list-group-item" href="{% url 'accounts:logout' %}"> Log out </a>
		</nav>
	</aside> <!-- col.// -->
	<main class="col-md-9">

		<article class="card mb-3">
			<div class="card-body">
				
				<figure class="icontext">
						<div class="icon">
							{% if user.image %}
								<img class="rounded-circle img-sm border" src="{{ user.image.url }}" alt="{{ user.username }}">
							{% else %}
								<img class="rounded-circle img-sm border" src="{% static 'images/avatars/avatar3.jpg' %}">
							{% endif %}
						</div>
						<div class="text">
							<strong> {{ user.get_full_name|default:user.username }} </strong> <br> 
							<p class="mb-2"> {{ user.email }}  </p> 
							<a href="{% url 'accounts:profile_settings' %}" class="btn btn-light btn-sm">Edit</a>
						</div>
				</figure>
				<hr>
				<p>
					<i class="fa fa-map-marker text-muted"></i> &nbsp; My address:  
					 <br>
					{{ user.address|default:"No address added yet" }} &nbsp 
					<a href="{% url 'accounts:profile_address' %}" class="btn-link"> Edit</a>
				</p>

				<article class="card-group card-stat">
					<figure class="card bg">
						<div class="p-3">
							 <h4 class="title">{{ orders_count }}</h4>
							<span>Orders</span>
						</div>
					</figure>
					<figure class="card bg">
						<div class="p-3">
							 <h4 class="title">{{ wishlist_count }}</h4>
							<span>Wishlists</span>
						</div>
					</figure>
					<figure class="card bg">
						<div class="p-3">
							 <h4 class="title">{{ awaiting_delivery }}</h4>
							<span>Awaiting delivery</span>
						</div>
					</figure>
					<figure class="card bg">
						<div class="p-3">
							 <h4 class="title">{{ delivered_items }}</h4>
							<span>Delivered items</span>
						</div>
					</figure>
				</article>

			</div> <!-- card-body .// -->
		</article> <!-- card.// -->

		<article class="card mb-3">
			<div class="card-body">
				<h5 class="card-title mb-4">Recent orders </h5>	

				{% if recent_orders %}
				<div class="row">
					{% for order in recent_orders %}
					<div class="col-md-6">
						<figure class="itemside mb-3">
							<div class="aside">
								<img src="{% static 'images/items/1.jpg' %}" class="border img-sm">
							</div>
							<figcaption class="info">
								<time class="text-muted"><i class="fa fa-calendar-alt"></i> {{ order.created_at|date:"d.m.Y" }}</time>
								<p>Order #{{ order.id }}</p>
								<span class="text-success">{{ order.status }}</span>
							</figcaption>
						</figure>
					</div>
					{% endfor %}
				</div>

				<a href="{% url 'accounts:profile_orders' %}" class="btn btn-outline-primary btn-block"> 
					See all orders <i class="fa fa-chevron-down"></i>
				</a>
				{% else %}
				<div class="alert alert-info text-center">
					<p>You don't have any orders yet.</p>
					<a href="{% url 'main:product_list' %}" class="btn btn-primary">Start Shopping</a>
				</div>
				{% endif %}
			</div> <!-- card-body .// -->
		</article> <!-- card.// -->

	</main> <!-- col.// -->
</div>

</div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

{% endblock content %}